<!DOCTYPE html>
<html>
<head>
  <title>Fast Palm Detector (Wide Camera)</title>
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
  <!-- Handpose model -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/handpose"></script>
</head>
<body>
  <h2 id="status">Palm: Not Detected ❌</h2>
  <video id="video" autoplay playsinline style="display:none"></video>

  <script>
    async function setupCamera() {
      const video = document.getElementById('video');
      const stream = await navigator.mediaDevices.getUserMedia({
        video: {
          facingMode: { exact: "user" }, // back camera (wider angle)
          width: { ideal: 1280 }, // request higher resolution
          height: { ideal: 720 }
        }
      });
      video.srcObject = stream;
      return new Promise(resolve => {
        video.onloadedmetadata = () => resolve(video);
      });
    }

    async function main() {
      const video = await setupCamera();
      await video.play();

      const model = await handpose.load();
      console.log("Handpose ready");

      const status = document.getElementById("status");

      async function detect() {
        const predictions = await model.estimateHands(video);
        if (predictions.length > 0) {
          status.innerText = "Palm: Detected ✅";
        } else {
          status.innerText = "Palm: Not Detected ❌";
        }
        requestAnimationFrame(detect); // keeps ~60fps responsiveness
      }

      detect();
    }

    main();
  </script>
</body>
</html>
