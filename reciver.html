<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bluetooth Palm Receiver</title>
</head>
<body>
  <h2>Received Image Code:</h2>
  <p id="output">Waiting...</p>
  <img id="viewer" width="300">

  <script>
    let images = {
      "pic1": "pic1.jpg",
      "pic2": "pic2.jpg",
      "pic3": "pic3.jpg"
    };

    async function connectBluetooth() {
      try {
        let device = await navigator.bluetooth.requestDevice({
          acceptAllDevices: true,
          optionalServices: ['12345678-1234-5678-1234-56789abcdef0']
        });
        let server = await device.gatt.connect();
        let service = await server.getPrimaryService('12345678-1234-5678-1234-56789abcdef0');
        let characteristic = await service.getCharacteristic('12345678-1234-5678-1234-56789abcdef1');

        characteristic.startNotifications();
        characteristic.addEventListener("characteristicvaluechanged", event => {
          let decoder = new TextDecoder();
          let code = decoder.decode(event.target.value);
          document.getElementById("output").innerText = code;
          if (images[code]) {
            document.getElementById("viewer").src = images[code];
          }
        });
        alert("Receiver connected!");
      } catch (e) {
        alert("Error: " + e);
      }
    }

    connectBluetooth();
  </script>
</body>
</html>
